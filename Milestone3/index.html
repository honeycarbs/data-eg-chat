<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
<div id="map" style="height: 600px;"></div>

<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiaGhrMiIsImEiOiJjbWF4aG1oMTMwcGZ3MmlxMDg3dXNicThlIn0.tKYQ7QLvRBDjKqwISXgFnA';

    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v11',
        zoom: 12 
    });

    fetch('http://127.0.0.1:5000/api/trip/1')
        .then(res => res.json())
        .then(data => {
            map.on('load', () => {
                if (data.features && data.features.length > 0) {
                    const firstPoint = data.features[0].geometry.coordinates;
                    const firstPointLng = firstPoint[0];  // Longitude
                    const firstPointLat = firstPoint[1];  // Latitude

                    map.setCenter([firstPointLng, firstPointLat]);

                    map.setZoom(14); 
                }

                // Add the GeoJSON source
                map.addSource('breadcrumb', {
                    type: 'geojson',
                    data: data
                });

                // Add the circle layer to display the points
                map.addLayer({
                    id: 'breadcrumb-layer',
                    type: 'circle',
                    source: 'breadcrumb',
                    paint: {
                        'circle-radius': 8, 
                        'circle-color': '#FF5733',  
                        'circle-stroke-color': '#FFFFFF',
                        'circle-stroke-width': 2 
                    }
                });
            });
        })
        .catch(error => console.error('Error fetching GeoJSON data:', error));
</script>